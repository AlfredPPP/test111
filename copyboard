import os
import pythoncom
from win32com.shell import shell, shellcon

def create_shortcut(target_path, shortcut_name, shortcut_folder):
    # 拼接快捷方式的完整路径
    shortcut_path = os.path.join(shortcut_folder, f"{shortcut_name}.lnk")
    
    # 创建快捷方式
    shell_link = pythoncom.CoCreateInstance(
        shell.CLSID_ShellLink, None, pythoncom.CLSCTX_INPROC_SERVER, shell.IID_IShellLink
    )
    shell_link.SetPath(target_path)
    
    # 设置工作目录为目标的文件夹
    shell_link.SetWorkingDirectory(os.path.dirname(target_path))
    
    # 访问 IPersistFile 接口保存快捷方式
    persist_file = shell_link.QueryInterface(pythoncom.IID_IPersistFile)
    persist_file.Save(shortcut_path, 0)

    print(f"Shortcut '{shortcut_name}' created in '{shortcut_folder}'.")

# 使用示例
target = r"C:\path\to\target\file_or_folder"  # 目标路径
name = "aaa"  # 快捷方式名称
folder = r"C:\path\to\folder"  # 创建快捷方式的文件夹

create_shortcut(target, name, folder)