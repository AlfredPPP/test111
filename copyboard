class SortableSqlQueryModel(QSqlQueryModel):
    def __init__(self, parent=None):
        super().__init__(parent)
        self._base_sql = ""  # 保存原始 SQL（不包含 ORDER BY）

    def setBaseQuery(self, sql):
        self._base_sql = sql
        self.setQuery(sql)

    def sort(self, column, order):
        # 获取当前列的字段名
        column_name = self.headerData(column, Qt.Horizontal)
        order_sql = f"{self._base_sql} ORDER BY {column_name} {'ASC' if order == Qt.AscendingOrder else 'DESC'}"
        self.setQuery(order_sql)