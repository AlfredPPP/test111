import ctypes
import os

def get_shortcut_target(shortcut_path):
    # Constants for the shell link interfaces
    CLSID_ShellLink = ctypes.create_string_buffer(b"{00021401-0000-0000-C000-000000000046}")
    IID_IShellLink = ctypes.create_string_buffer(b"{000214F9-0000-0000-C000-000000000046}")
    
    # Create an instance of IShellLink
    shell = ctypes.windll.shell32
    shell_link = ctypes.pointer(ctypes.pointer(ctypes.c_void_p()))
    if shell.CoCreateInstance(ctypes.byref(CLSID_ShellLink), None, 1, ctypes.byref(IID_IShellLink), ctypes.byref(shell_link)):
        raise Exception("Failed to create IShellLink instance")
    
    # Load the shortcut file
    persist_file = shell_link.QueryInterface(pythoncom.IID_IPersistFile)
    persist_file.Load(shortcut_path)
    
    # Get the target path
    target_path = ctypes.create_unicode_buffer(260)
    shell_link.GetPath(target_path, 260, None, 0)
    
    return target_path.value

# Usage example
shortcut = r"C:\path\to\your\shortcut.lnk"
target = get_shortcut_target(shortcut)
print(f"Target path: {target}")