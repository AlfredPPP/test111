import shutil
import os
import time
import filecmp

def copy_files(copy_from=None, folder_copy_to='', model='') -> None:
    if not os.path.exists(folder_copy_to):
        os.makedirs(folder_copy_to)

    start_time = time.time()

    if model == 'folder':
        for filename in os.listdir(copy_from):
            remote_file = os.path.join(copy_from, filename)
            local_file = os.path.join(folder_copy_to, filename)
            if os.path.isfile(remote_file):
                if not os.path.exists(local_file) or not filecmp.cmp(remote_file, local_file, shallow=True):
                    try:
                        shutil.copy2(remote_file, local_file)
                    except Exception as e:
                        print(f"Failed to copy file {remote_file}. Reason: {e}")

    elif model == 'file':
        # 复制单个文件
        if os.path.isfile(copy_from):
            remote_file = copy_from
            local_file = os.path.join(folder_copy_to, os.path.basename(copy_from))
            try:
                shutil.copy2(remote_file, local_file)
                print(f"Successfully copied file {remote_file} to {local_file}")
            except Exception as e:
                print(f"Failed to copy file {remote_file}. Reason: {e}")
        else:
            print(f"The specified file {copy_from} does not exist.")

    end_time = time.time()
    print(f"Copying files took {end_time - start_time:.2f} seconds")

if __name__ == "__main__":
    # 示例调用
    fund_code = "BQ6C"
    copy_files(copy_from="C:/path/to/single/file.txt", folder_copy_to="C:/path/to/destination/folder", model='file')