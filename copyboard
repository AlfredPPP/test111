import pdfplumber
import json
import os

def extract_pdf_to_json(pdf_path):
    # 创建输出文件夹（如果不存在）
    output_folder = 'pdf_extractor_output'
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    # 获取 PDF 文件名（不含扩展名）
    pdf_filename = os.path.basename(pdf_path)
    json_filename = os.path.splitext(pdf_filename)[0] + '.json'
    json_path = os.path.join(output_folder, json_filename)

    # 打开 PDF 文件
    with pdfplumber.open(pdf_path) as pdf:
        content_list = []
        for i, page in enumerate(pdf.pages):
            page_text = page.extract_text()
            page_content = {
                "page_number": i + 1,
                "content": page_text
            }
            content_list.append(page_content)

    # 将内容写入 JSON 文件
    with open(json_path, 'w', encoding='utf-8') as json_file:
        json.dump(content_list, json_file, ensure_ascii=False, indent=4)

    print(f"PDF content extracted to {json_path}")

# 使用示例
pdf_path = 'example.pdf'  # 替换为你的PDF文件路径
extract_pdf_to_json(pdf_path)