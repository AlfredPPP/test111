import ctypes
from ctypes import wintypes
import os

def get_downloads_folder():
    # KNOWNFOLDERID for Downloads folder
    FOLDERID_Downloads = '{374DE290-123F-4565-9164-39C4925E467B}'
    SHGetKnownFolderPath = ctypes.windll.shell32.SHGetKnownFolderPath
    SHGetKnownFolderPath.argtypes = [
        ctypes.c_void_p, wintypes.DWORD,
        wintypes.HANDLE, ctypes.POINTER(ctypes.c_wchar_p)
    ]

    path_ptr = ctypes.c_wchar_p()
    result = SHGetKnownFolderPath(
        ctypes.byref(ctypes.c_char.from_buffer_copy(bytes.fromhex(FOLDERID_Downloads.replace('-', '')))),
        0, 0, ctypes.byref(path_ptr)
    )
    if result != 0:
        raise ctypes.WinError(result)

    return path_ptr.value

print(get_downloads_folder())